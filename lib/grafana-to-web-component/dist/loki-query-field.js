"use strict";(this.webpackChunkGrafanaToWebComponent=this.webpackChunkGrafanaToWebComponent||[]).push([[7142,1598],{39702:($,T)=>{var u;u={value:!0},T.hl=T.x=void 0,T.x={wordPattern:/(-?\d*\.\d\w*)|([^`~!#%^&*()\-=+\[{\]}\\|;:'",.<>\/?\s]+)/g,comments:{lineComment:"#"},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"},{open:"<",close:">"}],folding:{}};var M=["sum","avg","min","max","stddev","stdvar","count","topk","bottomk"],I=["json","logfmt","regexp","unpack","pattern"],N=["line_format","label_format"],C=["count_over_time","rate","bytes_over_time","bytes_rate","avg_over_time","sum_over_time","min_over_time","max_over_time","stdvar_over_time","stddev_over_time","quantile_over_time","first_over_time","last_over_time","absent_over_time"],S=["by","without"],Q="(".concat(S.reduce(function(V,H){return"".concat(V,"|").concat(H)}),")"),B=["+","-","*","/","%","^","==","!=",">","<",">=","<=","|=","!=","|~","!~","and","or","unless","|"],z=M.concat(I).concat(N).concat(C).concat(S);T.hl={ignoreCase:!1,defaultToken:"",tokenPostfix:".logql",keywords:z,operators:B,vectorMatching:Q,symbols:/[=><!~?:&|+\-*\/^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,digits:/\d+(_+\d+)*/,octaldigits:/[0-7]+(_+[0-7]+)*/,binarydigits:/[0-1]+(_+[0-1]+)*/,hexdigits:/[[0-9a-fA-F]+(_+[0-9a-fA-F]+)*/,integersuffix:/(ll|LL|u|U|l|L)?(ll|LL|u|U|l|L)?/,floatsuffix:/[fFlL]?/,tokenizer:{root:[[/@vectorMatching\s*(?=\()/,"type","@clauses"],[/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,"tag"],[/(^#.*$)/,"comment"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":"type","@default":"identifier"}}],[/"/,"string","@string_double"],[/'/,"string","@string_single"],[/`/,"string","@string_backtick"],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"delimiter","@default":""}}],[/\d+(?:ms|[smhdwy])/,"number"],[/\d*\d+[eE]([\-+]?\d+)?(@floatsuffix)/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?(@floatsuffix)/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F](@integersuffix)/,"number.hex"],[/0[0-7']*[0-7](@integersuffix)/,"number.octal"],[/0[bB][0-1']*[0-1](@integersuffix)/,"number.binary"],[/\d[\d']*\d(@integersuffix)/,"number"],[/\d(@integersuffix)/,"number"]],string_double:[[/\{\{(.*?)\}\}/,{token:"number"}],[/[^\\"]/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],string_single:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,"string","@pop"]],string_backtick:[[/\{\{(.*?)\}\}/,{token:"number"}],[/[^\\`]/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/`/,"string","@pop"]],clauses:[[/[^(,)]/,"tag"],[/\)/,"identifier","@pop"]],whitespace:[[/[ \t\r\n]+/,"white"]]}}},29681:($,T,u)=>{u.r(T),u.d(T,{default:()=>rt});var M=u(41407),I=u(86832),N=u(39953),C=u(66533),S=u(34032),Q=u(75766),B=u(39702),z=u(82803),V=u(13094);function H(){const e=new Map;return e.set("expandSuggestionDocs",(!0).toString()),{onDidChangeValue:t=>{},onDidChangeTarget:t=>{},onWillSaveState:t=>{},get:(t,n,s)=>e.get(t)??s,getBoolean:(t,n,s)=>{const r=e.get(t);return r!==void 0?r==="true":s},getNumber:(t,n,s)=>{const r=e.get(t);return r!==void 0?parseInt(r,10):s},store:(t,n,s,r)=>{n==null?e.delete(t):e.set(t,n.toString())},remove:(t,n)=>{e.delete(t)},keys:(t,n)=>Array.from(e.keys()),logStorage:()=>{console.log("logStorage: not implemented")},migrate:()=>Promise.resolve(void 0),isNew:t=>!0,flush:t=>Promise.resolve(void 0)}}let ce={storageService:H()};function de(){return ce}class Y extends Error{constructor(t){super(`Unexpected case in switch statement: ${JSON.stringify(t)}`)}}var J=u(38793),A=u(11569),y=u(29353),E=u(83566),Z=u(88553);const ge=[{type:"PATTERN",label:"{}",insertText:"{$0}",isSnippet:!0,triggerOnInsert:!0}],X=Z.$5.map(e=>({type:"FUNCTION",label:e.label,insertText:`${e.insertText??""}($0)`,isSnippet:!0,triggerOnInsert:!0,detail:e.detail,documentation:e.documentation})),q=Z.EH.map(e=>({type:"FUNCTION",label:e.label,insertText:`${e.insertText??""}({$0}[\\$__auto])`,isSnippet:!0,triggerOnInsert:!0,detail:e.detail,documentation:e.documentation})),pe=Z.md.map(e=>({type:"FUNCTION",label:e.label,insertText:`${e.insertText??""}($0)`,isSnippet:!0,triggerOnInsert:!0,detail:e.detail,documentation:e.documentation})),fe=["$__auto","1m","5m","10m","30m","1h","1d"].map(e=>({type:"DURATION",label:e,insertText:e})),me=[{type:"FUNCTION",label:"duration_seconds",documentation:"Will convert the label value in seconds from the go duration format (e.g 5m, 24s30ms).",insertText:"duration_seconds()"},{type:"FUNCTION",label:"duration",documentation:"Short version of duration_seconds().",insertText:"duration()"},{type:"FUNCTION",label:"bytes",documentation:"Will convert the label value to raw bytes applying the bytes unit (e.g. 5 MiB, 3k, 1G).",insertText:"bytes()"}],he=[{type:"FUNCTION",label:"--strict",documentation:"Strict parsing. The logfmt parser stops scanning the log line and returns early with an error when it encounters any poorly formatted key/value pair.",insertText:"--strict"},{type:"FUNCTION",label:"--keep-empty",documentation:"Retain standalone keys with empty value. The logfmt parser retains standalone keys (keys without a value) as labels with value set to empty string.",insertText:"--keep-empty"}],ye=[{operator:"|=",documentation:(0,y.kf)(E.B5.LineContains),afterPipe:!0},{operator:"!=",documentation:(0,y.kf)(E.B5.LineContainsNot)},{operator:"|~",documentation:(0,y.kf)(E.B5.LineMatchesRegex),afterPipe:!0},{operator:"!~",documentation:(0,y.kf)(E.B5.LineMatchesRegexNot)}];function Ee(e){return ye.filter(t=>!e||t.afterPipe).map(({operator:t,documentation:n})=>({type:"LINE_FILTER",label:`${t} ""`,insertText:`${e?t.replace("|",""):t} "$0"`,isSnippet:!0,documentation:n}))}function ee(e=""){const t=[];return t.push({type:"PIPE_OPERATION",label:"line_format",insertText:`${e}line_format "{{.$0}}"`,isSnippet:!0,documentation:(0,y.kf)(E.B5.LineFormat)}),t.push({type:"PIPE_OPERATION",label:"label_format",insertText:`${e}label_format`,isSnippet:!0,documentation:(0,y.kf)(E.B5.LabelFormat)}),t.push({type:"PIPE_OPERATION",label:"unwrap",insertText:`${e}unwrap`,documentation:(0,y.kf)(E.B5.Unwrap)}),t.push({type:"PIPE_OPERATION",label:"decolorize",insertText:`${e}decolorize`,documentation:(0,y.kf)(E.B5.Decolorize)}),t.push({type:"PIPE_OPERATION",label:"drop",insertText:`${e}drop`,documentation:(0,y.kf)(E.B5.Drop)}),t.push({type:"PIPE_OPERATION",label:"keep",insertText:`${e}keep`,documentation:(0,y.kf)(E.B5.Keep)}),t}async function Le(e){return(await e.getHistory()).map(n=>({type:"HISTORY",label:n,insertText:n}))}async function be(e,t){return(await t.getLabelNames(e)).map(s=>({type:"LABEL_NAME",label:s,insertText:`${s}=`,triggerOnInsert:!0}))}async function Ne(e,t){const{extractedLabelKeys:n}=await t.getParserAndLabelKeys(e);return n.map(s=>({type:"LABEL_NAME",label:s,insertText:s,triggerOnInsert:!1}))}const ve=["json","logfmt","pattern","regexp","unpack"];async function te(e,t,n,s,r,i){const l=new Set(ve),c=[],f=r.some(a=>a==="level");if(t){const a=i?"":" (detected)";s?(l.delete("unpack"),c.push({type:"PARSER",label:`unpack${a}`,insertText:`${e}unpack`,documentation:(0,y.kf)(E.B5.Unpack)})):(l.delete("json"),c.push({type:"PARSER",label:`json${a}`,insertText:`${e}json`,documentation:f?"Use it to get log-levels in the histogram":(0,y.kf)(E.B5.Json)}))}if(n){l.delete("logfmt");const a=i?"":" (detected)";c.push({type:"PARSER",label:`logfmt${a}`,insertText:`${e}logfmt`,documentation:f?"Get detected levels in the histogram":(0,y.kf)(E.B5.Logfmt)})}return Array.from(l).sort().forEach(a=>{c.push({type:"PARSER",label:a,insertText:`${e}${a}`,documentation:(0,y.kf)(a)})}),c}async function Te(e,t,n,s){let r=e;t&&(r=(0,I.trimEnd)(e,"| "));const{extractedLabelKeys:i,hasJSON:l,hasLogfmt:c,hasPack:f}=await s.getParserAndLabelKeys(r),g=(0,A.cQ)(r).queryWithParser,a=`${n?"":" "}${t?"":"| "}`,L=await te(a,l,c,f,i,g),d=ee(a),R=[...L,...d];return g&&i.forEach(P=>{R.push({type:"LABEL_NAME",label:`${P} (detected)`,insertText:`${a}${P}`,documentation:`"${P}" was suggested based on the content of your log lines for the label filter expression.`})}),g?[...R]:[...t&&n?[]:Ee(t),...R]}async function Ce(e,t,n,s){const r=e.trimEnd().endsWith(",");r&&(e=(0,I.trimEnd)(e,", "));const{extractedLabelKeys:i,hasJSON:l,hasLogfmt:c,hasPack:f}=await s.getParserAndLabelKeys(e),g=(0,A.cQ)(e).queryWithParser;let a=[];const L=await te("| ",l,c,f,i,g),d=ee("| ");!t&&!r?a=[...a,...he,...L,...d]:r||(a=[...a,...L,...d]);const R=n.length===0||r?"":", ",P=i.filter(x=>!n.includes(x)).map(x=>({type:"LABEL_NAME",label:x,insertText:R+x,triggerOnInsert:!1}));return a=[...a,...P],a}async function Ae(e,t,n,s){return(await s.getLabelValues(e,n)).map(i=>({type:"LABEL_VALUE",label:i,insertText:t?(0,J.U9)(i):`"${(0,J.U9)(i)}"`}))}async function Pe(e,t){const{unwrapLabelKeys:n}=await t.getParserAndLabelKeys(e);return[...n.map(r=>({type:"LABEL_NAME",label:r,insertText:r,triggerOnInsert:!1})),...me]}async function Oe(e,t){const{extractedLabelKeys:n}=await t.getParserAndLabelKeys(e);return[...n.map(r=>({type:"LABEL_NAME",label:r,insertText:r,triggerOnInsert:!1}))]}async function Ie(e,t){switch(e.type){case"EMPTY":case"AT_ROOT":return[...await Le(t),...ge,...X,...pe,...q];case"IN_RANGE":return fe;case"IN_GROUPING":return Ne(e.logQuery,t);case"IN_LABEL_SELECTOR_NO_LABEL_NAME":return be(e.otherLabels,t);case"IN_LABEL_SELECTOR_WITH_LABEL_NAME":return Ae(e.labelName,e.betweenQuotes,e.otherLabels,t);case"AFTER_SELECTOR":return Te(e.logQuery,e.afterPipe,e.hasSpace,t);case"AFTER_UNWRAP":return Pe(e.logQuery,t);case"IN_AGGREGATION":return[...q,...X];case"AFTER_KEEP_AND_DROP":return Oe(e.logQuery,t);case"IN_LOGFMT":return Ce(e.logQuery,e.flags,e.otherLabels,t);default:throw new Y(e)}}var o=u(71258);function Re(e,t){return e[t]}function m(e,t){let n=e;for(const[s,r]of t)if(n=Re(n,s),n===null||n.type.id!==r)return null;return n}function D(e,t){return t.slice(e.from,e.to)}function Se(e){const t=e.slice(1,e.length-1);if(e.startsWith('"')&&e.endsWith('"'))return t.replace(/\\"/gm,'"');if(e.startsWith("'")&&e.endsWith("'"))return t.replace(/\\'/gm,"'");if(e.startsWith("`")&&e.endsWith("`"))return t;throw new Error(`Invalid string literal: ${e}`)}function xe(e,t){return e.every((n,s)=>n===t[s])}const h=0,_e=[{paths:[[o.Qf]],fun:se},{paths:[[h,o.gP,o.Qf]],fun:se},{paths:[[o.WZ],[o.Tr],[h,o.UN,o.Tr],[h,o.nt],[o.UN],[h,o.nt],[o.nt]],fun:Be},{paths:[[o.WZ]],fun:De},{paths:[[o.Ld,o.xO]],fun:re},{paths:[[o.Kz]],fun:$e},{paths:[[o.UN]],fun:Ke},{paths:[[h,o.xO]],fun:re},{paths:[[h,o.e6]],fun:We},{paths:[[h,o.UN]],fun:Ge},{paths:[[h,o.dh,o.cq,o.M0]],fun:()=>({type:"IN_AGGREGATION"})},{paths:[[h,o.We,o.iP]],fun:Ue},{paths:[[h,o.Xt],[o.Xt]],fun:ke},{paths:[[h,o.yB],[h,o.Ph],[h,o.ge],[h,o.Di]],fun:Qe}],we=new Map([["Eq","="],["Re","=~"],["Neq","!="],["Nre","!~"]]);function Me(e){return we.get(e.name)??null}function Fe(e,t){if(e.type.id!==o.xO)return null;const n=m(e,[["firstChild",o.xb]]);if(n===null)return null;const s=n.nextSibling;if(s===null)return null;const r=Me(s);if(r===null)return null;const i=m(e,[["lastChild",o.Ld]]);if(i===null)return null;const l=D(n,t),c=Se(D(i,t));return{name:l,value:c,op:r}}function ne(e,t){if(e.type.id!==o.Qf)return[];let n=m(e,[["firstChild",o.gP]]);const s=[];for(;n!==null;){const r=m(n,[["lastChild",o.xO]]);if(r!==null){const i=Fe(r,t);i!==null&&s.push(i)}n=m(n,[["firstChild",o.gP]])}return s.reverse(),s}function ke(e,t,n){return{type:"AFTER_UNWRAP",logQuery:(0,A.Eb)(t,n).trim()}}function Ue(e,t,n){const s=m(e,[["parent",o.We],["parent",o.iP]]);if(s===null)return null;const{parent:r}=s;return r===null?null:r.type.id===o.bL||r.type.id===o.UN?W(r,t,n,!0):null}function $e(e,t,n){const s=m(e,[["parent",o.M0]]);if(s===null)return null;const r=s.getChild("MetricExpr");return r===null||m(r,[["firstChild",o.Tr],["lastChild",o.UN],["firstChild",o.Qf]])===null?null:{type:"IN_GROUPING",logQuery:(0,A.Eb)(t,n).trim()}}function re(e,t,n){const s=!e.type.isError,r=m(e,[["parent",o.xO]]);if(r===null)return null;const i=m(r,[["firstChild",o.xb]]);if(i===null)return null;const l=D(i,t),c=m(r,[["parent",o.gP]]);if(c===null)return null;let f=c,g=null;for(;g===null;){const d=f.parent;if(d===null)return null;switch(d.type.id){case o.gP:f=d;continue;case o.Qf:g=d;continue;default:return null}}const L=ne(g,t).filter(d=>d.name!==l);return{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",labelName:l,betweenQuotes:s,otherLabels:L}}function Be(e,t,n){const s=o.E2.parse(t),r=t.substring(0,n).trimEnd().length,i=r<n?r:n,l=s.cursorAt(i),c=[o.af,o.$Q,o.lc,o.nt];let f=!1;do{const{node:d}=l;if(c.includes(d.type.id)&&l.from<=i&&l.to>=i){f=!0;break}}while(l.next());if(!f)return null;const g=(0,A.Yk)(t,[o.$Q]).length>1;return{type:"IN_LOGFMT",otherLabels:(0,A.Yk)(t,[o.lc]).map(d=>d.getChild(o.xb)).filter(d=>d!==null).map(d=>D(d,t)),flags:g,logQuery:(0,A.Eb)(t,i).trim()}}function De(e,t,n){const s=m(e,[["lastChild",o.wi],["lastChild",o.bL]]);return s!=null?W(s,t,n,!1):m(e,[["firstChild",h],["firstChild",o.xb]])!=null?{type:"AT_ROOT"}:null}function We(e,t,n){return{type:"IN_RANGE"}}function Ke(e,t,n){const r=t.substring(0,n).trimEnd().endsWith("|");return W(e,t,n,r)}function Ge(e,t,n){const s=m(e,[["parent",o.UN]]);if(s===null)return null;const i=t.substring(0,n).trimEnd().endsWith("|");return W(s,t,n,i)}function W(e,t,n,s){const r=m(e,[["firstChild",o.Qf]]);return!r||r.to>n?null:{type:"AFTER_SELECTOR",afterPipe:s,hasSpace:t.charAt(n-1)===" ",logQuery:(0,A.Eb)(t,n).trim()}}function se(e,t,n){const s=m(e,[["firstChild",o.gP]]);if(s!==null&&!t.slice(s.from,n).trim().endsWith(","))return null;const r=e.type.id===h?m(e,[["parent",o.gP],["parent",o.Qf]]):e;return r?{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",otherLabels:ne(r,t)}:null}function Qe(e,t,n){let s=(0,A.Eb)(t,n).trim(),r=null,i=e.parent;for(;i!==null;){if(i.type.id===o.We){r=i;break}i=i.parent}return r?.type.id===o.We&&(s=s.slice(0,r.from)),{type:"AFTER_KEEP_AND_DROP",logQuery:s}}function ze(e,t,n){const s=t.trimEnd().length,r=s<n?s:n,i=e.cursorAt(r);do if(i.from===r&&i.to===r){const{node:l}=i;if(l.type.isError)return l}while(i.next());return null}function Ve(e,t){if(e==="")return{type:"EMPTY"};const n=o.E2.parse(e),s=ze(n,e,t),r=s!=null?s.cursor():n.cursorAt(t),i=r.node,l=[r.type.id];for(;r.parent();)l.push(r.type.id);for(let c of _e)for(let f of c.paths)if(xe(f,l)){const g=c.fun(i,e,t);if(g)return g}return null}const He=4;function Ze(){return{showWords:!1}}function je(e,t){switch(e){case"DURATION":return t.languages.CompletionItemKind.Unit;case"FUNCTION":return t.languages.CompletionItemKind.Variable;case"HISTORY":return t.languages.CompletionItemKind.Snippet;case"LABEL_NAME":return t.languages.CompletionItemKind.Enum;case"LABEL_VALUE":return t.languages.CompletionItemKind.EnumMember;case"PATTERN":return t.languages.CompletionItemKind.Constructor;case"PARSER":return t.languages.CompletionItemKind.Class;case"LINE_FILTER":return t.languages.CompletionItemKind.TypeParameter;case"PIPE_OPERATION":return t.languages.CompletionItemKind.Interface;default:throw new Y(e)}}function Ye(e,t){return{triggerCharacters:["{",",","[","(","=","~"," ",'"',"|"],provideCompletionItems:(s,r)=>{const i=s.getWordAtPosition(r),l=i!=null?e.Range.lift({startLineNumber:r.lineNumber,endLineNumber:r.lineNumber,startColumn:i.startColumn,endColumn:i.endColumn}):e.Range.fromPositions(r),c={column:r.column,lineNumber:r.lineNumber},f=s.getOffsetAt(c),g=Ve(s.getValue(),f);return(g!=null?Ie(g,t):Promise.resolve([])).then(L=>{const d=L.length.toString().length;return{suggestions:L.map((b,P)=>({kind:je(b.type,e),label:b.label,insertText:b.insertText,insertTextRules:b.isSnippet?He:void 0,detail:b.detail,documentation:b.documentation,sortText:P.toString().padStart(d,"0"),range:l,command:b.triggerOnInsert?{id:"editor.action.triggerSuggest",title:""}:void 0}))}})}}}var Je=u(63163);class Xe{constructor(t,n={current:[]}){this.languageProvider=t,this.historyRef=n}buildSelector(t){return`{${t.map(s=>`${s.name}${s.op}"${(0,Je.U9)(s.value)}"`).join(",")}}`}getHistory(){return(0,I.chain)(this.historyRef.current).map(t=>t.query.expr).filter().uniq().value()}async getLabelNames(t=[]){if(t.length===0)return this.languageProvider.getLabelKeys();const n=await this.getSeriesLabels(t),s=Object.keys(n),r=new Set(t.map(i=>i.name));return s.filter(i=>!r.has(i))}async getLabelValues(t,n){return n.length===0?await this.languageProvider.getLabelValues(t):(await this.getSeriesLabels(n))[t]??[]}async getParserAndLabelKeys(t){return await this.languageProvider.getParserAndLabelKeys(t)}async getSeriesLabels(t){return await this.languageProvider.getSeriesLabels(this.buildSelector(t)).then(n=>n??{})}}var oe=u(16699);const qe={codeLens:!1,contextmenu:!1,fixedOverflowWidgets:!0,folding:!1,fontSize:14,lineDecorationsWidth:8,lineNumbers:"off",minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:4,bottom:5},renderLineHighlight:"none",scrollbar:{vertical:"hidden",verticalScrollbarSize:8,horizontal:"hidden",horizontalScrollbarSize:0},scrollBeyondLastLine:!1,suggest:Ze(),suggestFontSize:12,wordWrap:"on"},et=2,F="logql";let ie=!1;function tt(e){ie===!1&&(ie=!0,e.languages.register({id:F}),e.languages.setMonarchTokensProvider(F,B.hl),e.languages.setLanguageConfiguration(F,B.x))}const nt=(e,t)=>({container:(0,M.css)`
      border-radius: ${e.shape.radius.default};
      border: 1px solid ${e.components.input.borderColor};
      width: 100%;
      .monaco-editor .suggest-widget {
        min-width: 50%;
      }
    `,placeholder:(0,M.css)`
      ::after {
        content: '${t}';
        font-family: ${e.typography.fontFamilyMonospace};
        opacity: 0.3;
      }
    `}),rt=({history:e,onBlur:t,onRunQuery:n,initialValue:s,datasource:r,placeholder:i,onChange:l})=>{const c=(0,S.Z)(),f=(0,N.useRef)(de()),g=(0,N.useRef)(null),a=(0,C.Z)(r.languageProvider),L=(0,C.Z)(e),d=(0,C.Z)(n),R=(0,C.Z)(t),b=(0,N.useRef)(null),P=(0,z.l4)(),x=nt(P,i);(0,N.useEffect)(()=>()=>{b.current?.()},[]);const st=(p,v)=>{const K=[{range:new p.Range(1,1,1,1),options:{className:x.placeholder,isWholeLine:!0}}];let G=[];const k=()=>{const U=v.getModel();if(!U)return;const j=U.getValueLength()===0?K:[];G=U.deltaDecorations(G,j)};k(),v.onDidChangeModelContent(k)},ot=(0,I.debounce)(async p=>{l(p)},1e3);return N.createElement("div",{"aria-label":Q.wl.components.QueryField.container,className:x.container,ref:g},N.createElement(V.o,{overrideServices:f.current,options:qe,language:F,value:s,beforeMount:p=>{tt(p)},onMount:(p,v)=>{const K=p.createContextKey("isEditorFocused"+c,!1);p.onDidBlurEditorWidget(()=>{K.set(!1),R.current(p.getValue())}),p.onDidChangeModelContent(_=>{const O=p.getModel();if(!O)return;const w=O.getValue(),it=((0,oe.O)(w,r.interpolateString(w,oe.t),O.getLinesContent())||[]).map(({error:ue,...lt})=>({message:`${ue?`Error parsing "${ue}"`:"Parse error"}. The query appears to be incorrect and could fail to be executed.`,severity:v.MarkerSeverity.Error,...lt}));ot(w),v.editor.setModelMarkers(O,"owner",it)});const G=new Xe(a.current,L),k=Ye(v,G),U={...k,provideCompletionItems:(_,O,w,ae)=>p.getModel()?.id!==_.id?{suggestions:[]}:k.provideCompletionItems(_,O,w,ae)},{dispose:j}=v.languages.registerCompletionItemProvider(F,U);b.current=j;const le=()=>{const _=g.current;if(_!==null){const O=p.getContentHeight();_.style.height=`${O+et}px`;const w=_.clientWidth;p.layout({width:w,height:O})}};p.onDidContentSizeChange(le),le(),p.addCommand(v.KeyMod.Shift|v.KeyCode.Enter,()=>{d.current(p.getValue())},"isEditorFocused"+c),p.onDidFocusEditorText(()=>{K.set(!0),p.getValue().trim()===""&&p.trigger("","editor.action.triggerSuggest",{})}),st(v,p)}}))}},66533:($,T,u)=>{u.d(T,{Z:()=>N});var M=u(39953),I=function(C){var S=(0,M.useRef)(C);return S.current=C,S};const N=I},93716:$=>{$.exports={id:"loki"}}}]);

//# sourceMappingURL=loki-query-field.js.map